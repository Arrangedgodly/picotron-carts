picotron cartridge // www.picotron.net
version 2

:: afx/
:: afx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTEyIDA2OjU4OjM5Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSJdXQ==
:: gfx/
:: gfx/0.gfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIwOjU1OjM5Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSIscmV2aXNpb249MTE4Nl1dbHo0AGECAADOMgAA8yF7WzBdPXtibXA9cHh1
AEMgEBAE8FYHEAfAF9AXwAcQB-BWLGZsYWdzPTAscGFuX3gIAMt5PTAsem9vbT04fSw_AP8ZAwbQ
FtAGECaQVpAWEAagBiAGMEZAZgAGYBZAFmAGQBbAFsAW0AbwJlgAHfAGFycAF2CHUEcgF1AXMCew
F9A34AfACAB-J8An4AfwFVAAHf8KFl8WgC6wHtAO4F6gToAukD6wbtA_oE7gLksAH-8jFDWwBUAl
YBUANQAFgBUwBXAVMBVwBQAFEBVwFQA1gAUgFYAVEGVAFRAVMAVgVcAF8BdiAB3xFwUvFaAuwA4w
TlAOIC4AHlAuMB5QHhAuEB5ALjAOAB5ADgAOMA4ABgCwEE4ALjAOED4ALlAcAL8OYC4gLnBekC7w
CHUAHvAPbw9wHtAeED6ADgAeEB5wDgAOIB6ALgAuUH4ADjBObQDgMA4QDiAOEB4wHgAOIA6ZAAAG
AG9wfpBe8BRvABnyDiAgBPAkDxLwDh7wDS7wDQ4QDtBecA4QDvAEDlAeBwDwEA4wDvACjiAe8AAu
IF4QDuAuIC4wPtAeIC4wTsAuAE6QAHCQLgAuAA5Q8QDwAE4gDjA_ID6gDjAOIE4AXggAkBAuAG4A
DrAOIKwAQE4gHrAcAP8mXiAewA4wPhAuMA7QTgAOAD4wLvABTjA_AA7wAg4AvvACDjA_AB7wBU4w
XvADDqAe8A8O8JPaAAsdNUkBH-AxAAsfOTEA----------------------------------------
----------------------9gUG09OX19
:: gfx/sprites.gfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTEzIDAwOjIwOjA1Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwMjowODo1MCIscmV2aXNpb249OV1dbHo0AMkCAADJNAAA8yF7WzBdPXtibXA9cHh1AEMg
EBAE8FYHEAfAF9AXwAcQB-BWLGZsYWdzPTAscGFuX3gIAMp5PTAsem9vbT04fSw_APEAwSABLxAB
JhEGAQ4BEAEuCgAzHgEACgBQLhEuAVYGAPYAcS4R3hHeER6RHhEeAXcBBgA-FzEXDgADL-EBigAc
8QDMIAwvHAwmHAYMDgwQDC4KADMeDAAKAFAuHC4MVgYA9gB8LhzeHN4cHpweHB4MdwwGAD8XPBcO
AAMf-IoAHfUC-yAB1h7WHtb_AQAOJgd2DhAGAIAOFg42DiAOFgkAPyYOMAkACCAeBgkARxYOUA4J
AF9WDmB_MI0AHWIXAd8YHxcEANP-FwEADi8YCH0OEA4tBgCADh0OPQ4gDh0JAD8tDjAJAAggHg0J
AEcdDlAOCQAfXZQAIPETMIVQBY8gBTAFrgUwBZ4FQGUuBTAFUAUuBSAFDgVABS4FEAwAU04VTgUg
DgAxQAUODACTUAUwBS5lQAWePgBPjgVQhX8AHvERhlAGhwYwBqcGMAaXBkBmJwYwBlAGJwYgBgcG
QAYnBhAMAFNHFkcGIA4AMUAGBwwAk1AGMAYnZkAGlz4AT4cGUIZ_AB3wETWwBS8gFZAFThVwBW4V
UAWOFTAFrhUQBc4FAAXeFd4VCAAAEAAAGAAAIAAAKABfLhWQNbBoABzwEDawBicWkAZHFnAGZxZQ
BocWMAanFhAGxwYABtcW1xYIAAAQAAAYAAAgAAAoAE8nFpA2ZwAdv-ACtSAFvyAFEAW_BAAWTyC1
8AJnAB5vtiAGtwYQBAAYLyC2ZgAfgQMlMCVABS8gdAI-MAUuCABCb0AlMCXwA5sAHjQmMCaeAh8w
CABET0AmMCaaAB8f8DEA--------------------------------------------------------
-----4lQbT04fX0=
:: gfx/ui.gfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTEzIDAyOjA4OjU4Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSIscmV2aXNpb249MzU1XV1sejQAbAMAAMQ1AADzIXtbMF09e2JtcD1weHUA
QyAQEATwVgcQB8AX0BfABxAH8FYsZmxhZ3M9MCxwYW5feAgAynk9MCx6b29tPTV9LD4A8QDBIAEv
EAEmEQYBDgEQAS4KADMeAQAKAFAuES4BVgYA9gBxLhHeEd4RHpEeER4BdwEGAD8XMRcOAAMv8QGK
ABzxAMwgDC8cDCYcBgwODBAMLgoAMx4MAAoAUC4cLgxWBgD2AHwuHN4c3hwenB4cHgx3DAYAPxc8
Fw4AAx-8igAd9QL-IAHWHtYe1v4BAA4mB3YOEAYAgA4WDjYOIA4WCQA-Jg4wCQAIIB4GCQBHFg5Q
DgkAX1YOYH4wjQAdYhcB3xgfFwQA0-8XAQAOLxgIfQ4QDi0GAIAOHQ49DiAOHQkAPy0OMAkACCAe
DQkARx0OUA4JAB9dlAAg8RIwh1AHhgcwB6YHMAeWB0BnJgcwB1AHJgcgBwYHQAcmBxAMAFNGF0YH
IA4AMUAHBgwAk1AHMAcmZ0AHlj4AT4YHUId_AB7xEYZQBocGMAanBjAGlwZAZicGMAZQBicGIAYH
BkAGJwYQDABTRxZHBiAOADFABgcMAJNQBjAGJ2ZABpc_AE_HBlCGfgAd8BA3sAcmF5AHRhdwB2YX
UAeGFzAHphcQB8YHAAfWF9YXCAAAEAAAGAAAIAAAKABfJheQN7BnABzwEDawBicWkAZHFnAGZxZQ
BocWMAanFhAGxwYABtcW1xYIAAAQAAAYAAAgAAAoAE8nFpA2ZwAdj-ACtyAHtgcQBAAYTyC38AJm
AB5vtiAGtwYQBAAYLyC2ZgAfRAMnMCd-Ah8wCABEb0AnMCfwA5oAHjQmMCabAh8wCABET0AmMCaa
AB7-AJA0oFQQBMoQBA8ZuRAEDgQAEz-U8AFnACHq1BDUECS6ACQPGakAJA4EAIAUDrkAFA6pEAQA
AGMALw65-wEfgxYmQAZQBhcWCAQhFhAIAOI3FgAGBwYARkcmBxanFgQAIJcmEgACGgAGKgACOgBv
UCZABvARfAAecydAB1AHFhcCBSEXEAgA4jYXAAcGBwBHRicGF6YXBAAglicSAAIaAAYqAAI6AE9Q
J0AHfAAfH-AxAP-----------------------------------------------------------8RQ
bT01fX0=
:: gfx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIxOjAzOjIwIixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSJdXQ==
:: map/
:: map/0.map
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIwOjU1OjM5Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSIscmV2aXNpb249MTE0M11dbHo0AGgAAABYEAAA8Ah7e2JtcD11c2VyZGF0
YSgiaTE2IiwzMgMALyIwAQD--------------------78QgiKSxoaWRkZW49ZmFsc2UscGFuX3g9
MAgA0nk9MCx0aWxlX2g9MTYKABB3CgCAem9vbT0xfX0=
:: map/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIxOjAzOjIwIixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSJdXQ==
:: sfx/
:: sfx/0.sfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIwOjU1OjM5Iixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSIscmV2aXNpb249MTEzMF1dbHo0AKAAAAALCgAA-zBweHUAAygAAAQABA9A
EAIOAAGgASACoA4ADxAADfDKAQIDQA8PkAQFBgdADJAICQoLQAyQDwwPDQ8ODEAM8P8BAOv-J6oB
EAYPIBABIAEgAfAAAhACDhABIA8hIAEwD0Dwww8oD--wxg-4Cg--D4AP9w8NAfAJARAGDjAA----
--_9H-8BAKzPyA9AAA8QQP--sPD-AQD-6lD-----KQ==
:: sfx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIxOjAzOjIwIixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSJdXQ==
:: vgfx/
:: vgfx/0.vgfx
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIwOjU3OjMwIixtb2RpZmllZD0iMjAyNC0x
Mi0xMSAyMTowMzoyMCIscmV2aXNpb249MzBdXWx6NACOAAAA0QAAALB7e3tjb2xfYT0xLAgA8Cti
PTE2LGZpbGw9NDM2OTAsbmFtZT0iIixvdXRsaW5lPS0xLHBvaW50cz17ezQwLC00MH0sey0xMCwx
CQDzDjAsNDB9fSxzaG93PXRydWUsdHlwZT0iZWFyIn0saAATOGgAEjJnAE8zNzc0ZwALFS1oAD8x
MyxmAApQciJ9fX0=
:: vgfx/.info.pod
b64$LS1bW3BvZCxjcmVhdGVkPSIyMDI0LTEyLTExIDIwOjU3OjMwIixtb2RpZmllZD0iMjAyNC0x
Mi0xMyAwNjo0NjowMSJdXQ==
:: button.lua
--[[pod_format="raw",created="2024-12-13 05:48:40",modified="2024-12-13 06:46:01",revision=130]]
-- Create a hoverable button with consistent behavior and optional active state
function create_hover_button(parent, config)
    -- Default configuration
    config = config or {}
    local default_config = {
        x = 0,
        y = 0,
        width = 16,
        height = 16,
        normal_sprite = nil,     -- Sprite shown in normal state
        hover_sprite = nil,      -- Sprite shown when hovered
        active_sprite = nil,     -- Sprite shown when active (if toggle_mode is true)
        active_hover_sprite = nil, -- Sprite shown when active and hovered
        hover_duration = 2,      -- How long hover effect lasts
        toggle_mode = false,     -- Whether the button toggles between states
        onclick = function() end, -- Click handler
        onactivate = function() end,   -- Called when button becomes active
        ondeactivate = function() end  -- Called when button becomes inactive
    }

    -- Merge provided config with defaults
    for k,v in pairs(default_config) do
        if config[k] == nil then
            config[k] = v
        end
    end

    return parent:attach{
        x = config.x,
        y = config.y,
        width = config.width,
        height = config.height,
        hovered = 0,
        active = false,
        
        draw = function(self)
            if self.active then
                if self.hovered > 0 and config.active_hover_sprite then
                    spr(config.active_hover_sprite)
                elseif config.active_sprite then
                    spr(config.active_sprite)
                end
            else
                if self.hovered > 0 and config.hover_sprite then
                    spr(config.hover_sprite)
                elseif config.normal_sprite then
                    spr(config.normal_sprite)
                end
            end
        end,
        
        hover = function(self)
            self.hovered = config.hover_duration
        end,
        
        update = function(self)
            if self.hovered > 0 then
                self.hovered -= 1
            end
        end,
        
        click = function(self)
            if config.toggle_mode then
                self.active = not self.active
                if self.active then
                    config.onactivate(self)
                else
                    config.ondeactivate(self)
                end
            end
            config.onclick(self)
        end,

        -- Helper methods to control state externally
        set_active = function(self, state)
            self.active = state
            if state then
                config.onactivate(self)
            else
                config.ondeactivate(self)
            end
        end
    }
end

-- Helper function to create a button group container
function create_button_group(parent, config)
    return parent:attach{
        x = config.x or 0,
        y = config.y or 0,
        width = config.width or parent.width,
        height = config.height or 16
    }
end
:: gui.lua
--[[pod_format="raw",created="2024-12-11 21:26:33",modified="2024-12-13 06:46:01",revision=1401]]
gui = create_gui()

include("button.lua")

local ui = fetch("./gfx/ui.gfx")
local colors = {
    menu_background = theme"icon0",
    button_unselect = theme"icon1",
    button_select = theme"icon0",
    button_text = theme"icon2",
    container_bg = 5,
}

local menuBar = gui:attach{
    x=330,
    y=0,
    width = 150,
    height = 270,
    draw = function(self)
        rectfill(0,0,self.width,self.height,colors.menu_background)
    end
}

local text_bar = menuBar:attach_text_editor{
    x = 5,
    y = 20,
    width = 140,
    height = 15,
    block_scrolling = true
}

local controls = create_button_group(menuBar, {
    x = 5,
    y = 2
})

local loadButton = create_hover_button(controls, {
    x = 30,
    normal_sprite = ui[13].bmp,
    hover_sprite = ui[14].bmp,
    onclick = function()
        popup_open = true
    end
})

local saveButton = create_hover_button(controls, {
    x = 60,
    normal_sprite = ui[1].bmp,
    hover_sprite = ui[2].bmp
})

local deleteButton = create_hover_button(controls, {
    x = 90,
    normal_sprite = ui[3].bmp,
    hover_sprite = ui[4].bmp
})

local playback = create_button_group(menuBar, {
    x = 5,
    y = 40
})

local playButton = create_hover_button(playback, {
    x = 40,
    normal_sprite = ui[8].bmp,
    hover_sprite = ui[7].bmp,
    active_sprite = ui[12].bmp,
    active_hover_sprite = ui[11].bmp,
    toggle_mode = true,
    onactivate = function(self)
    	animation_playing = true
    end,
    ondeactivate = function(self)
    	animation_playing = false
    end
})

local loopButton = create_hover_button(playback, {
    x = 80,
    normal_sprite = ui[6].bmp,
    hover_sprite = ui[5].bmp,
    active_sprite = ui[15].bmp,
    active_hover_sprite = ui[16].bmp,
    toggle_mode = true,
    onactivate = function(self)
    	animation_looping = true
    end,
    ondeactivate = function(self)
    	animation_looping = false
    end
})
:: main.lua
--[[pod_format="raw",author="Arranged Godly",created="2024-12-11 20:55:39",modified="2024-12-13 06:46:01",notes="A tool for creating afx\nanimation files from gfx files",revision=1323,title="Animation Editor",version="0.1"]]
include "gui.lua"
include "popup.lua"

popup_open = false

function _init()
  get_display()
  window({
    width = 480,
    height = 270,
    title = "temp.afx",
    has_frame = false,
    show_toolbar = true,
    tabbed = true,
    icon = userdata("[gfx]08087770777077707770777077700700070077777707777777777777777777777707[/gfx]"),
    x = 0,
    y = 0
  })
  
  mkdir("/ram/cart/afx")
  
end

function _update()
	gui:update_all()
	
	if popup_open then popup_gui:update_all() end
	
	if key("escape") then
		stop()
	end
end

function _draw()
	cls(theme"window_frame")
	gui:draw_all()
	
	if popup_open then popup_gui:draw_all() end
  
end
:: popup.lua
--[[pod_format="raw",created="2024-12-12 17:19:03",modified="2024-12-13 06:46:01",revision=812]]
popup_gui = create_gui()

close_hover_sprite = userdata("[gfx]08085500005555500555055555500055550000555500055555505550055555000055[/gfx]")
close_sprite = userdata("[gfx]08082200002222200222022222200022220000222200022222202220022222000022[/gfx]")

settings = {
	height = 8,
	width = 8
}

frame = 1
local isDragging = false

local Window = popup_gui:attach{
	x = 50,
	y = 5,
	width = 256,
	height = 250,
	isDragging = false,
	draw = function(self)
		fillBG(self,6)
	end,
	click = function(self)
		self.isDragging = true
	end,
	release = function(self)
		self.isDragging = false
	end
}

local closeButton = popup_gui:attach{
	x = 310,
	y = 2,
	width = 8,
	height = 8,
	hovered = 0,
	draw = function(self)
		if self.hovered > 0 then
			spr(close_sprite)
		else
			spr(close_hover_sprite)
		end
	end,
	hover = function(self)
		self.hovered = 2
	end,
	click = function(self)
		popup_open = false
	end,
	update = function(self)
		if self.hovered > 0 then
			self.hovered -= 1
		end
	end
}

for h = 0, settings.height - 1 do
	for w = 0, settings.width - 1 do
		Window:attach{
			x = w * 32,
			y = h * 32,
			width = 32,
			height = 32,
			selected = false,
			hovered = 0,
			sprite_num = frame,
			draw = function(self)
				rectfill(0, 0, self.width, self.height, 0)
				sspr(self.sprite_num, 0, 0, 16, 16, 0, 0, 32, 32)
				if self.selected then
    				rect(0, 0, self.width-1, self.height-1, 7)
				end	
			end,
			hover = function(self)
				self.hovered = 2
			end,
			update = function(self)
				if self.hovered > 0 then
					self.hovered -= 1
					if Window.isDragging then
						self.selected = not self.selected
					end
				end
			end
		}
		frame += 1
	end
end

function fillBG(self, col)
	rectfill(0,0,self.width,self.height,col)
end
:: .info.pod
b64$LS1bW3BvZCxhdXRob3I9IkFycmFuZ2VkIEdvZGx5IixjcmVhdGVkPSIyMDI0LTEyLTExIDIw
OjU2OjIzIixpY29uPXVzZXJkYXRhKCJ1OCIsMTYsMTYsIjAwMDAwMDAwMDAwMDBkMGQwZDBkMGQw
ZDBkMDAwMDAwMDAwZDBkMGQwZDBkMGQwNzA3MDcwNzA3MGQwMDAwMDAwMDBkMDcwNzA3MGQwZDA3
MDEwMTAxMDcwZDAwMDAwMDAwMGQwNzAxMDcwZDBkMDcwMTAxMDEwNzBkMDAwMDAwMDAwZDA3MDcw
NzBkMGQwNzA3MDcwNzA3MGQwMDAwMDAwZDBkMGQwNzBkMGQwZDBkMGQwNzBkMGQwZDBkMGQwZDBk
MDcwNzA3MDcwNzA3MDcwNzA3MDcwNzBkMGQwNzBkMGQwNzA3MDcwNzA3MDcwNzA3MDcwNzA3MGQw
NzA2MGQwZDA3MDcwNzAxMDEwMTA3MDEwMTAxMDcwNzA2MDYwZDBkMDcwNzA3MDEwNzAxMDcwMTA3
MDcwNzA3MDYwNjBkMGQwNzA3MDcwMTAxMDEwNzAxMDEwNzA3MDcwNjA2MGQwZDA3MDcwNzAxMDcw
MTA3MDEwNzA3MDcwNzA2MDYwZDBkMGQwNzA3MDEwNzAxMDcwMTAxMDEwNzA3MDYwNjBkMDAwZDBk
MDcwNzA3MDcwNzA3MDcwNzA3MGQwNzA2MGQwMDAwMGQwZDA3MDcwNzA3MDcwNzA3MDcwZDBkMDcw
ZDAwMDAwMDBkMGQwZDBkMGQwZDBkMGQwZDBkMGQwZDBkIiksbW9kaWZpZWQ9IjIwMjQtMTItMTMg
MDY6NDY6MDEiLG5vdGVzPSJBIHRvb2wgZm9yIGNvbnZlcnRpbmcgZ2Z4XG5maWxlcyBpbnRvIGFm
eCBhbmltYXRpb25zIixydW50aW1lPTEyLHRpdGxlPSJBbmltYXRpb24gRWRpdG9yIix2ZXJzaW9u
PSIwLjEiLHdvcmtzcGFjZXM9e3tsb2NhdGlvbj0ibWFpbi5sdWEjMjEiLHdvcmtzcGFjZV9pbmRl
eD0xfSx7bG9jYXRpb249Imd1aS5sdWEjODciLHdvcmtzcGFjZV9pbmRleD0xfSx7bG9jYXRpb249
InBvcHVwLmx1YSM3NiIsd29ya3NwYWNlX2luZGV4PTF9LHtsb2NhdGlvbj0iYnV0dG9uLmx1YSM5
NCIsd29ya3NwYWNlX2luZGV4PTF9LHtsb2NhdGlvbj0iZ2Z4LzAuZ2Z4Iix3b3Jrc3BhY2VfaW5k
ZXg9Mn0se2xvY2F0aW9uPSJnZngvdWkuZ2Z4Iix3b3Jrc3BhY2VfaW5kZXg9Mn0se2xvY2F0aW9u
PSJtYXAvMC5tYXAiLHdvcmtzcGFjZV9pbmRleD0zfSx7bG9jYXRpb249InNmeC8wLnNmeCIsd29y
a3NwYWNlX2luZGV4PTR9fV1d
:: [eoc]
